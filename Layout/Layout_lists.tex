
%\setlist[itemize]{label=\textbullet}
\newcommand{\listsymbol}{\textbullet}

%%% Captions lists %%%

\newcommand{\captionlist}{\vspace*{3pt}\newline}
\newcommand{\captionitem}{\hspace*{0.3cm}}


%%% Lists with prices %%%

\newcommand{\startpricelist}{\raggedcolumns\begin{multicols}{2}\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]}
\def\endpricelist{\end{description}\end{multicols}}
\newcommand{\pricelistitem}[3]{\item \begin{samepage}\textbf{#1}\predotfill\hfill\nobreak\pts{#2}\newline{#3}\end{samepage}\par}
\newcommand{\nopricelistitem}[1]{\item \textbf{#1}\newline}

\newcommand{\startpricelistNSP}{\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]}
\def\endpricelistNSP{\end{description}}

\newcommand{\startsortedpricelist}{%
	\begin{samepage}\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]%
	\DTLifdbexists{sortedpricelist}{\DTLcleardb{sortedpricelist}}{\DTLnewdb{sortedpricelist}}% Create new/discard old list
}
\def\endsortedpricelist{%
	\DTLsort*{costsortlabel=descending,sortlabel}{sortedpricelist}% Sort list
	\DTLforeach*{sortedpricelist}{\ruletext=ruletext,\nameoftheitem=name,\cost=cost}{% Print back the ordered table
	\begin{samepage}\pricelistitem{\nameoftheitem}{\cost}%
	\ruletext{}\end{samepage}%
	}%
	\end{description}\end{samepage}%
}

\newcommand{\sortedpricelistitem}[3]{%
	\DTLnewrow{sortedpricelist}%
	\DTLnewdbentry{sortedpricelist}{name}{#1}%
	\DTLnewdbentry{sortedpricelist}{cost}{#2}%
	\DTLnewdbentry{sortedpricelist}{ruletext}{#3}%
	\pdfstringdef\textwithoutformatting{#1}%
	\pdfsubstitute\textwithoutformatting{'}{}%
	\pdfsubstitute\textwithoutformatting{ }{}%
	\dolanguagespecificsubstitute{}%
	\def\DTLentrycommand{\DTLnewdbentry{sortedpricelist}{sortlabel}}%
	\expandafter\DTLentrycommand\expandafter{\textwithoutformatting}%
	\pdfstringdef\costwithoutformatting{#2}%
	\pdfsubstitute\costwithoutformatting{ }{}%
	\pdfsubstitute\costwithoutformatting{\free}{0}%
	\pdfsubstitute\costwithoutformatting{\nolimit}{999999}%
	\substitute\costwithoutformatting{\string\376}{}%
	\substitute\costwithoutformatting{\string\377}{}%
	\substitute\costwithoutformatting{\string\000}{}%
	\def\DTLentrycommand{\DTLnewdbentry{sortedpricelist}{costsortlabel}}%
	\expandafter\DTLentrycommand\expandafter{\costwithoutformatting}%
}

\newcommand{\sortedpricelistitemhtgt}[3]{%
	\sortedpricelistitem{#1}{#2}{#3}%
	\def\temphypertag{}%
	\StrGobbleRight{\expandafter\@gobble\string#1}{1}[\temphypertag] % remove first the \ to the left and then the {} to the right - it counts as 1 character and then bug the hyperlink tag. It will remove the last character of the macro name if there is no {} in the end of the name key. So it should always be input as "name=\fancyunitname{},". "name=\fancyunitname," will make hyperlinks crash.
	\xdef\SPLitemhypertag{\temphypertag}% using the unit name macro to define an hypertag
	\def\DTLentrycommand{\DTLnewdbentry{sortedpricelist}{itemhypertag}}%
	\expandafter\DTLentrycommand\expandafter{\SPLitemhypertag}%
}

\newcommand{\startsortedpricelistNSP}{%
	\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]%
	\DTLifdbexists{sortedpricelist}{\DTLcleardb{sortedpricelist}}{\DTLnewdb{sortedpricelist}}% Create new/discard old list
}
\def\endsortedpricelistNSP{%
	\DTLsort*{costsortlabel=descending,sortlabel}{sortedpricelist}% Sort list
	\DTLforeach*{sortedpricelist}{\ruletext=ruletext,\nameoftheitem=name,\cost=cost}{% Print back the ordered table
	\pricelistitem{\nameoftheitem}{\cost}%
	\ruletext{}%
	}%
	\end{description}%
}

\newcommand{\startsortedpricelisthtgt}{%
	\begin{samepage}\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]%
	\DTLifdbexists{sortedpricelist}{\DTLcleardb{sortedpricelist}}{\DTLnewdb{sortedpricelist}}% Create new/discard old list
}
\def\endsortedpricelisthtgt{%
	\DTLsort*{costsortlabel=descending,sortlabel}{sortedpricelist}% Sort list
	\DTLforeach*{sortedpricelist}{\ruletext=ruletext,\nameoftheitem=name,\cost=cost,\itemhypertag=itemhypertag}{% Print back the ordered table
	\begin{samepage}\expandafter\hypertarget\expandafter{\itemhypertag}{\pricelistitem{\nameoftheitem}{\cost}%
	\ruletext{}}\end{samepage}%
	}%
	\end{description}\end{samepage}%
}

\newcommand{\startsortedpricelisthtgtNSP}{%
	\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]%
	\DTLifdbexists{sortedpricelist}{\DTLcleardb{sortedpricelist}}{\DTLnewdb{sortedpricelist}}% Create new/discard old list
}
\def\endsortedpricelisthtgtNSP{%
	\DTLsort*{costsortlabel=descending,sortlabel}{sortedpricelist}% Sort list
	\DTLforeach*{sortedpricelist}{\ruletext=ruletext,\nameoftheitem=name,\cost=cost,\itemhypertag=itemhypertag}{% Print back the ordered table
	\expandafter\hypertarget\expandafter{\itemhypertag}{\pricelistitem{\nameoftheitem}{\cost}%
	\ruletext{}}%
	}%
	\end{description}%
}

\newcommand{\startitemlist}{\raggedcolumns\begin{multicols}{2}\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]}
\def\enditemlist{\end{description}\end{multicols}}
\newcommand{\listitem}[1]{\item[#1\spacebeforecolon{}:]}

\newcommand{\startitemlistonecol}{\begin{description}[leftmargin=0.3cm, labelindent=0cm, labelsep=0.1cm, itemsep=8pt]}
\def\enditemlistonecol{\end{description}}
\newcommand{\listitemonecol}[1]{\item \textbf{#1\spacebeforecolon{}:}\newline}

\newenvironment{smallitemize}{\begin{itemize}[itemsep=3pt,topsep=3pt]}{\end{itemize}}
\newenvironment{smallenumerate}{\begin{enumerate}[itemsep=3pt,topsep=3pt]}{\end{enumerate}}

%%% Army Model Rules sorting

\newcommand{\startAMRsortedlist}{%
	\DTLifdbexists{AMRlist}{\DTLcleardb{AMRlist}}{\DTLnewdb{AMRlist}}% Create new/discard old list
}

\newcommand{\closeAMRsortedlist}{%
	\DTLsort*{sortlabel}{AMRlist}% Sort list
	\DTLforeach*{AMRlist}{\name=name,\ruletext=ruletext}{%
		\subsubtitle{\name}
		\ruletext{}\par%
	}
	\DTLcleardb{AMRlist}%
}

\newcommand{\AMRsortedlistentry}[2]{%
	\DTLnewrow{AMRlist}%
	\pdfstringdef\textwithoutformatting{#1}%
	\pdfsubstitute\textwithoutformatting{'}{}%
	\pdfsubstitute\textwithoutformatting{ }{}%
	\dolanguagespecificsubstitute{}%
	\def\DTLentrycommand{\DTLnewdbentry{AMRlist}{sortlabel}}%
	\expandafter\DTLentrycommand\expandafter{\textwithoutformatting}%
	\DTLnewdbentry{AMRlist}{name}{#1}%
	\DTLnewdbentry{AMRlist}{ruletext}{#2}%
}
